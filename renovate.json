{
    "$schema": "https://docs.renovatebot.com/renovate-schema.json",
    "extends": ["config:recommended"],
    "lockFileMaintenance": {
        "enabled": true
    },
    "nix": {
        "enabled": true
    },
    "pinDigests": true,
    "digest": {
        "dependencyDashboardApproval": true
    },
    "osvVulnerabilityAlerts": true,
    "vulnerabilityAlerts": {
        "enabled": true
    },
    "reviewers": ["xgroleau"],
    "platformAutomerge": true,
    "customManagers": [
        {
            "customType": "regex",
            "managerFilePatterns": ["/^.*\\.nix$/"],
            "matchStrings": [
                "\\w*[iI]mage\\s*=\\s*\"(?<depName>[^\\n\\r:]+):(?<currentValue>[^\\n\\r@\"]+)(?:@(?<currentDigest>sha256:[A-Fa-f0-9]+))?\""
            ],
            "datasourceTemplate": "docker"
        }
    ],
    "packageRules": [
        {
            "enabled": false,
            "description": "Freeze major DB  updates",
            "matchUpdateTypes": ["major"],
            "matchPackageNames": [
                "/postgres/",
                "/mysql/",
                "/mariadb/",
                "/mongodb/"
            ]
        },
        {
            "description": "Auto merge Docker digest updates (only docker, we don't want to update flakes digest)",
            "matchDatasources": ["docker"],
            "matchUpdateTypes": ["digest"],
            "dependencyDashboardApproval": false,
            "automerge": true
        }
    ]
}
